(this["webpackJsonpreact-burger"]=this["webpackJsonpreact-burger"]||[]).push([[0],{10:function(e,t,n){e.exports={number:"orderIngredientsDetails_number__2oVga",statusDone:"orderIngredientsDetails_statusDone__1m91H",statusPedding:"orderIngredientsDetails_statusPedding__UXPAB",subtitle:"orderIngredientsDetails_subtitle__2Hak9",orders:"orderIngredientsDetails_orders__3Z96E",order:"orderIngredientsDetails_order__1zkY-",imgContainer:"orderIngredientsDetails_imgContainer__35BjF",img:"orderIngredientsDetails_img__2TVFx",ingredientName:"orderIngredientsDetails_ingredientName__1H9jn",priceWrapper:"orderIngredientsDetails_priceWrapper__2CmQX",count:"orderIngredientsDetails_count__31bfl",multiplier:"orderIngredientsDetails_multiplier__LvPMt",price:"orderIngredientsDetails_price__3FoBW",icon:"orderIngredientsDetails_icon__1Bjhp",footer:"orderIngredientsDetails_footer__1xRTU","total\u0421ost":"orderIngredientsDetails_total\u0421ost__KRyeO"}},110:function(e,t,n){e.exports={burgerConstructorIngridient:"burgerConstructorIngridient_burgerConstructorIngridient__Dqwf4"}},111:function(e,t,n){e.exports={modalOverlay:"modalOverlay_modalOverlay__1kR9g"}},112:function(e,t,n){e.exports={ingredientDetailsPage:"ingredientDetailsPage_ingredientDetailsPage__jVVuF"}},113:function(e,t,n){e.exports={container:"orderIngredientsDetailsPage_container__1oX5r"}},12:function(e,t,n){e.exports={feed:"feed_feed__18GWp",feed__container:"feed_feed__container__3dBcN",feed__orders:"feed_feed__orders__1h7Jt",feed__status:"feed_feed__status__mo3K_",feed__statusContainer:"feed_feed__statusContainer__19_i7",feed__statusTitle:"feed_feed__statusTitle__3tBSU",feed__statusList:"feed_feed__statusList__PCc_b",feed__statusItemDone:"feed_feed__statusItemDone__2xmsK",feed__statisticsTitle:"feed_feed__statisticsTitle__10fd6",feed__statisticsInfo:"feed_feed__statisticsInfo__1Dz3R"}},122:function(e,t,n){},16:function(e,t,n){e.exports={order:"order_order__3S06G",statusDone:"order_statusDone__2YVqi",statusPedding:"order_statusPedding__23h_d",order_link:"order_order_link__2T49g",order__meta:"order_order__meta__3ULkJ",order__title:"order_order__title__2v4lb",order__info:"order_order__info__JoCKj",order__cost:"order_order__cost__rGlxN",order__costNumber:"order_order__costNumber__2PZvD",order__icon:"order_order__icon__1C5BM",order__ingredients:"order_order__ingredients__f96Zv"}},206:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n.n(r),a=n(41),i=n.n(a),s=(n(121),n(122),n(11)),o=n(83),l=n.n(o),_=n(21),d=n.n(_),u=n(6),m=n(4),j=n(0),b=function(){var e=Object(s.h)();return Object(j.jsx)("header",{className:d.a.header,children:Object(j.jsxs)("div",{className:d.a.container,children:[Object(j.jsxs)("ul",{className:d.a.navigation,children:[Object(j.jsx)("li",{className:"mt-4 mb-4 mr-2 pr-5 pl-5 \u0445\u0443\u0439",children:Object(j.jsxs)(u.c,{to:"/",exact:!0,className:d.a.navigationLink,activeClassName:"".concat(d.a.navigationLink__active),children:[Object(j.jsx)(m.BurgerIcon,{type:"/"===e.pathname?"primary":"secondary"}),Object(j.jsx)("p",{className:"text text_type_main-default text_color_inactive ml-2 ".concat(d.a.linkText),children:"\u041a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0442\u043e\u0440"})]})}),Object(j.jsx)("li",{className:"mt-4 mb-4 pr-5 pl-5",children:Object(j.jsxs)(u.c,{to:"/feed",exact:!0,className:d.a.navigationLink,activeClassName:"".concat(d.a.navigationLink__active),children:[Object(j.jsx)(m.ListIcon,{type:"/feed"===e.pathname?"primary":"secondary"}),Object(j.jsx)("p",{className:"text text_type_main-default text_color_inactive ml-2 ".concat(d.a.linkText),children:"\u041b\u0435\u043d\u0442\u0430 \u0437\u0430\u043a\u0430\u0437\u043e\u0432"})]})})]}),Object(j.jsx)(u.b,{to:"/",children:Object(j.jsx)(m.Logo,{})}),Object(j.jsxs)(u.c,{to:"/profile",className:d.a.profile,activeClassName:"".concat(d.a.navigationLink__active),children:[Object(j.jsx)(m.ProfileIcon,{type:"/profile"===e.pathname||"/profile/order"===e.pathname?"primary":"secondary"}),Object(j.jsx)("p",{className:"text text_type_main-default text_color_inactive ml-2 ".concat(d.a.linkText),children:"\u041b\u0438\u0447\u043d\u044b\u0439 \u043a\u0430\u0431\u0438\u043d\u0435\u0442"})]})]})})},p=n(5),f=n(25),x=n.n(f),O=n(49),g=O.c,h=function(){return Object(O.b)()},N=n(2),v="GET_ALL_INGRIDIENTS_REQUEST",y="GET_ALL_INGRIDIENTS_SUCCESS",I="GET_ALL_INGRIDIENTS_FAILED",C="OPEN_INGRIDIENT_DATA",T="CLOSE_INGRIDIENT_DATA",k="https://norma.nomoreparties.space/api";function E(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(e.status))}var S="GET_USER",D="CLEAN_USER";function w(e,t,n){var r=(n=Object(N.a)({path:"/"},n)).expires;if("number"==typeof r&&r){var c=new Date;c.setTime(c.getTime()+1e3*r),r=n.expires=c}r&&r.toUTCString&&(n.expires=r.toUTCString());var a=e+"="+(t=encodeURIComponent(t));for(var i in n){a+="; "+i;var s=n[i];!0!==s&&(a+="="+s)}document.cookie=a}function R(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0}function L(e){w(e,!1,{expires:-1})}var P=function e(t,n){return function(r){fetch("".concat(k,"/auth/user"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:t||""}}).then((function(e){return e.ok?e.json():Promise.reject(e.json())})).then((function(e){e&&e.success&&r({type:S,email:e.user.email,name:e.user.name})})).catch((function(e){return e})).then((function(t){t&&"jwt expired"===t.message&&fetch("".concat(k,"/auth/token"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:"".concat(n)})}).then(E).then((function(t){var n=t.accessToken.split("Bearer ")[1],r=t.refreshToken;return w("token",n),w("refreshToken",t.refreshToken),e(n,r)}))})).catch((function(e){console.log(e)}))}},B=function(){var e=h(),t=Object(s.h)().state,n=g((function(e){return e.user})),c=n.user,a=Object(r.useState)(""),i=Object(p.a)(a,2),o=i[0],l=i[1],_=Object(r.useState)(""),d=Object(p.a)(_,2),b=d[0],f=d[1];return c?Object(j.jsx)(s.a,{to:(null===t||void 0===t?void 0:t.from)||"/"}):Object(j.jsxs)("div",{className:x.a.login,children:[Object(j.jsx)("h1",{className:"text text_type_main-medium mb-6 ".concat(x.a.login__title),children:"\u0412\u0445\u043e\u0434"}),Object(j.jsxs)("form",{onSubmit:function(t){t.preventDefault(),e(function(e){return function(t){fetch("".concat(k,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(E).then((function(e){e&&e.success&&(w("token",e.accessToken.split("Bearer ")[1]),w("refreshToken",e.refreshToken),t({type:S,email:e.user.email,name:e.user.name}))})).catch((function(e){console.log(e)}))}}({email:o,password:b}))},action:"#",className:"mb-20 ".concat(x.a.login__form),children:[Object(j.jsx)("div",{className:"mb-6 ".concat(x.a.login__input),children:Object(j.jsx)(m.EmailInput,{onChange:function(e){l(e.target.value)},value:o,name:"email"})}),Object(j.jsx)("div",{className:"mb-6 ".concat(x.a.login__input),children:Object(j.jsx)(m.PasswordInput,{onChange:function(e){f(e.target.value)},value:b,name:"password"})}),Object(j.jsx)(m.Button,{type:"primary",size:"medium",children:"\u0412\u043e\u0439\u0442\u0438"})]}),Object(j.jsxs)("div",{className:"mb-4 ".concat(x.a.login__wrapper),children:[Object(j.jsx)("span",{className:"mr-2 text text_type_main-default text_color_inactive",children:"\u0412\u044b \u2014 \u043d\u043e\u0432\u044b\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c?"}),Object(j.jsx)(u.b,{to:"/register",className:"text text_type_main-default ".concat(x.a.login__link),children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})]}),Object(j.jsxs)("div",{className:"".concat(x.a.login__wrapper),children:[Object(j.jsx)("span",{className:"mr-2 text text_type_main-default text_color_inactive",children:"\u0417\u0430\u0431\u044b\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c?"}),Object(j.jsx)(u.b,{to:"/forgot-password",className:"text text_type_main-default ".concat(x.a.login__link),children:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c"})]})]})},A=n(42),U=n(29),G=n.n(U),M=function(){var e=g((function(e){return e.user})).user,t=h(),n=Object(r.useState)({email:"",password:"",name:""}),c=Object(p.a)(n,2),a=c[0],i=c[1],o=function(e){i(Object(N.a)(Object(N.a)({},a),{},Object(A.a)({},e.target.name,e.target.value)))},l=Object(r.useCallback)((function(e){e.preventDefault(),t(function(e){return function(t){return fetch("".concat(k,"/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(E).then((function(e){e&&e.success&&(w("token",e.accessToken.split("Bearer ")[1]),w("refreshToken",e.refreshToken),t({type:S,email:e.user.email,name:e.user.name}))})).catch((function(e){console.log(e)}))}}(a))}),[t,a]);return e?Object(j.jsx)(s.a,{to:{pathname:"/"}}):Object(j.jsxs)("div",{className:G.a.registration,children:[Object(j.jsx)("h1",{className:"text text_type_main-medium mb-6 ".concat(G.a.registration__title),children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(j.jsxs)("form",{onSubmit:l,action:"#",className:"mb-20 ".concat(G.a.registration__form),children:[Object(j.jsx)("div",{className:"mb-6 ".concat(G.a.registration__input),children:Object(j.jsx)(m.Input,{type:"text",placeholder:"\u0418\u043c\u044f",onChange:o,value:a.name,name:"name",error:!1,errorText:"\u041e\u0448\u0438\u0431\u043a\u0430",size:"default"})}),Object(j.jsx)("div",{className:"mb-6 ".concat(G.a.registration__input),children:Object(j.jsx)(m.EmailInput,{onChange:o,value:a.email,name:"email"})}),Object(j.jsx)("div",{className:"mb-6 ".concat(G.a.registration__input),children:Object(j.jsx)(m.PasswordInput,{onChange:o,value:a.password,name:"password"})}),Object(j.jsx)(m.Button,{type:"primary",size:"medium",children:"\u0412\u043e\u0439\u0442\u0438"})]}),Object(j.jsxs)("div",{className:"".concat(G.a.registration__wrapper),children:[Object(j.jsx)("span",{className:"mr-2 text text_type_main-default text_color_inactive",children:"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b?"}),Object(j.jsx)(u.b,{to:"/login",className:"text text_type_main-default ".concat(G.a.registration__link),children:"\u0412\u043e\u0439\u0442\u0438"})]})]})},z=n(38),F=n.n(z),W=function(){var e=Object(s.h)(),t=h(),n=e.state,c=g((function(e){return e.user})),a=c.user,i=Object(r.useState)(""),o=Object(p.a)(i,2),l=o[0],_=o[1],d=Object(r.useState)(!1),b=Object(p.a)(d,2),f=b[0],x=b[1];return f?Object(j.jsx)(s.a,{to:{pathname:"/reset-password",state:{from:e}}}):a?Object(j.jsx)(s.a,{to:(null===n||void 0===n?void 0:n.from)||"/"}):Object(j.jsxs)("div",{className:F.a.forgot,children:[Object(j.jsx)("h1",{className:"text text_type_main-medium mb-6 ".concat(F.a.forgot__title),children:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u0430\u0440\u043e\u043b\u044f"}),Object(j.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t(function(e,t){return function(n){fetch("".concat(k,"/password-reset"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(E).then((function(e){e&&e.success&&t(!0)})).catch((function(e){console.log(e)}))}}({email:l},x))},action:"#",className:"mb-20 ".concat(F.a.forgot__form),children:[Object(j.jsx)("div",{className:"mb-6 ".concat(F.a.forgot__input),children:Object(j.jsx)(m.EmailInput,{onChange:function(e){_(e.target.value)},value:l,name:"email"})}),Object(j.jsx)(m.Button,{type:"primary",size:"medium",children:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c"})]}),Object(j.jsxs)("div",{className:"".concat(F.a.forgot__wrapper),children:[Object(j.jsx)("span",{className:"mr-2 text text_type_main-default text_color_inactive",children:"\u0412\u0441\u043f\u043e\u043c\u043d\u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c?"}),Object(j.jsx)(u.b,{to:"/login",className:"text text_type_main-default ".concat(F.a.forgot__link),children:"\u0412\u043e\u0439\u0442\u0438"})]})]})},H=n(32),J=n.n(H),q=function(){var e=Object(s.h)().state,t=g((function(e){return e.user})),n=t.user,c=Object(r.useState)(""),a=Object(p.a)(c,2),i=a[0],o=a[1],l=Object(r.useState)(""),_=Object(p.a)(l,2),d=_[0],b=_[1],f=h();return n?Object(j.jsx)(s.a,{to:{pathname:"/"}}):"/forgot-password"!==(null===e||void 0===e?void 0:e.from.pathname)?Object(j.jsx)(s.a,{to:{pathname:"/login"}}):Object(j.jsxs)("div",{className:J.a.reset,children:[Object(j.jsx)("h1",{className:"text text_type_main-medium mb-6 ".concat(J.a.reset__title),children:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u0430\u0440\u043e\u043b\u044f"}),Object(j.jsxs)("form",{onSubmit:function(e){e.preventDefault(),f(function(e){return function(t){fetch("".concat(k,"/password-reset/reset"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(E).then((function(e){e&&e.success&&console.log(e)})).catch((function(e){console.log(e)}))}}({password:i,token:d})),o(""),b("")},action:"#",className:"mb-20 ".concat(J.a.reset__form),children:[Object(j.jsx)("div",{className:"mb-6 ".concat(J.a.reset__input),children:Object(j.jsx)(m.PasswordInput,{onChange:function(e){o(e.target.value)},value:i,name:"password"})}),Object(j.jsx)("div",{className:"mb-6 ".concat(J.a.reset__input),children:Object(j.jsx)(m.Input,{type:"text",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0434 \u0438\u0437 \u043f\u0438\u0441\u044c\u043c\u0430",onChange:function(e){b(e.target.value)},value:d,name:"code",error:!1,errorText:"\u041e\u0448\u0438\u0431\u043a\u0430",size:"default"})}),Object(j.jsx)(m.Button,{type:"primary",size:"medium",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]}),Object(j.jsxs)("div",{className:"".concat(J.a.reset__wrapper),children:[Object(j.jsx)("span",{className:"mr-2 text text_type_main-default text_color_inactive",children:"\u0412\u0441\u043f\u043e\u043c\u043d\u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c?"}),Object(j.jsx)(u.b,{to:"/login",className:"text text_type_main-default ".concat(J.a.reset__link),children:"\u0412\u043e\u0439\u0442\u0438"})]})]})},V=n(26),K=n.n(V),Q=n(24),X=n.n(Q),Z=function(){var e=h();return Object(j.jsxs)("ul",{className:"mr-15 pl-5 ".concat(X.a.menu),children:[Object(j.jsx)("li",{className:"".concat(X.a.menu__item),children:Object(j.jsx)(u.c,{exact:!0,to:"/profile",className:"text text_type_main-medium ".concat(X.a.menu__link),activeClassName:"".concat(X.a.menu__linkActive),children:"\u041f\u0440\u043e\u0444\u0438\u043b\u044c"})}),Object(j.jsx)("li",{className:"".concat(X.a.menu__item),children:Object(j.jsx)(u.c,{exact:!0,to:"/profile/order",className:"text text_type_main-medium ".concat(X.a.menu__link),activeClassName:"".concat(X.a.menu__linkActive),children:"\u0418\u0441\u0442\u043e\u0440\u0438\u044f \u0437\u0430\u043a\u0430\u0437\u043e\u0432"})}),Object(j.jsx)("li",{className:"text text_type_main-medium ".concat(X.a.menu__item),children:Object(j.jsx)(u.c,{to:"/login",className:"text text_type_main-medium ".concat(X.a.menu__link),activeClassName:"".concat(X.a.menu__linkActive),onClick:function(t){t.preventDefault();var n=R("refreshToken");e(function(e){return function(t){fetch("".concat(k,"/auth/logout"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:"".concat(e)})}).then(E).then((function(e){t({type:D,user:null}),L("token"),L("refreshToken")})).catch((function(e){console.log(e)}))}}(n))},children:"\u0412\u044b\u0445\u043e\u0434"})})]})},Y=function(){var e=g((function(e){return e.user})).user,t=Object(r.useState)({name:e?e.name:"",email:e?e.email:"",password:""}),n=Object(p.a)(t,2),c=n[0],a=n[1],i=Object(r.useState)(!1),s=Object(p.a)(i,2),o=s[0],l=s[1],_=function(e){a(Object(N.a)(Object(N.a)({},c),{},Object(A.a)({},e.target.name,e.target.value))),l(!0)},d=h(),u=function(t){t.preventDefault(),a({name:e?e.name:"",email:e?e.email:"",password:""})},b=o?Object(j.jsxs)("div",{className:"".concat(K.a.profile__formActions),children:[Object(j.jsx)(m.Button,{onClick:u,type:"secondary",size:"medium",children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),Object(j.jsx)(m.Button,{type:"primary",size:"medium",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]}):null;return Object(j.jsxs)("div",{className:K.a.profile,children:[Object(j.jsxs)("div",{className:K.a.profile__menu,children:[Object(j.jsx)(Z,{}),Object(j.jsx)("div",{className:"mt-20 pl-5 ".concat(K.a.profile__info),children:Object(j.jsx)("span",{className:"text text_type_main-default text_color_inactive ".concat(K.a.profile__infoItem),children:"\u0412 \u044d\u0442\u043e\u043c \u0440\u0430\u0437\u0434\u0435\u043b\u0435 \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0441\u0432\u043e\u0438 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435"})})]}),Object(j.jsxs)("form",{onSubmit:function(e){e.preventDefault();var t,n,r="Bearer "+R("token");d((t=r,n=c,function(e){fetch("".concat(k,"/auth/user"),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:t||""},body:JSON.stringify(n)}).then(E).then((function(t){t&&t.success&&e({type:S,email:t.user.email,name:t.user.name})})).catch((function(e){console.log(e)}))})),console.log("ss")},action:"#",className:"".concat(K.a.profile__form),children:[Object(j.jsx)("div",{className:"mb-6 ".concat(K.a.profile__input),children:Object(j.jsx)(m.Input,{type:"text",placeholder:"\u0418\u043c\u044f",onChange:_,value:c.name,name:"name",error:!1,errorText:"\u041e\u0448\u0438\u0431\u043a\u0430",size:"default"})}),Object(j.jsx)("div",{className:"mb-6 ".concat(K.a.profile__input),children:Object(j.jsx)(m.Input,{type:"text",placeholder:"\u041b\u043e\u0433\u0438\u043d",onChange:_,value:c.email,name:"email",error:!1,errorText:"\u041e\u0448\u0438\u0431\u043a\u0430",size:"default"})}),Object(j.jsx)("div",{className:"mb-6 ".concat(K.a.profile__input),children:Object(j.jsx)(m.PasswordInput,{onChange:_,value:c.password,name:"password"})}),b]})]})},$=n(30),ee=n.n($),te=n(212),ne=n(61),re=n.n(ne),ce=function(e){var t=e.onClick,n=e.item,r=e.id,c=g((function(e){return e.order})).constructorIngridientsId,a=Object(s.h)();var i=Object(te.a)({type:"ingredient",item:{item:n}}),o=Object(p.a)(i,2)[1];return Object(j.jsx)(u.b,{to:{pathname:"ingredients/".concat(r),state:{background:a}},className:"".concat(re.a.burgerIngredient),children:Object(j.jsxs)("li",{ref:o,onClick:t,id:r,className:"mr-2 ml-2 ".concat(re.a.burgerIngredient__item),children:[Object(j.jsx)(m.Counter,{count:function(e){var t=0;return c.forEach((function(n){n===e._id&&("bun"===e.type?t=2:t+=1)})),t}(n),size:"default"}),Object(j.jsx)("img",{className:"mr-4 ml-4 mb-2",src:n.image,alt:n.name}),Object(j.jsxs)("div",{className:"mb-2 ".concat(re.a.burgerIngredient__price),children:[Object(j.jsx)("p",{className:"mr-2 text text_type_digits-default",children:n.price}),Object(j.jsx)(m.CurrencyIcon,{type:"primary"})]}),Object(j.jsx)("p",{className:"mb-8 text text_type_main-default",children:n.name})]},n._id)})},ae=function(e){var t=e.onClick,n=Object(r.useState)("one"),c=Object(p.a)(n,2),a=c[0],i=c[1],s=g((function(e){return e.ingridients})).ingridients,o=Object(r.useRef)(null),l=Object(r.useRef)(null),_=Object(r.useRef)(null);return Object(j.jsxs)("section",{className:"mr-10 ml-5 ".concat(ee.a.burgerIngredients," "),children:[Object(j.jsx)("h1",{className:"mt-10 mb-5 text text_type_main-large",children:"\u0421\u043e\u0431\u0435\u0440\u0438\u0442\u0435 \u0431\u0443\u0440\u0433\u0435\u0440"}),Object(j.jsxs)("div",{style:{display:"flex"},children:[Object(j.jsx)(m.Tab,{value:"one",active:"one"===a,onClick:function(e){var t;i(e),null===(t=o.current)||void 0===t||t.scrollIntoView({behavior:"smooth"})},children:"\u0411\u0443\u043b\u043a\u0438"}),Object(j.jsx)(m.Tab,{value:"two",active:"two"===a,onClick:function(e){var t;i(e),null===(t=l.current)||void 0===t||t.scrollIntoView({behavior:"smooth"})},children:"\u0421\u043e\u0443\u0441\u044b"}),Object(j.jsx)(m.Tab,{value:"three",active:"three"===a,onClick:function(e){var t;i(e),null===(t=_.current)||void 0===t||t.scrollIntoView({behavior:"smooth"})},children:"\u041d\u0430\u0447\u0438\u043d\u043a\u0438"})]}),Object(j.jsxs)("div",{className:"".concat(ee.a.burgerIngredients__scrollWrapper),onScroll:function(e){var t=e.target.getBoundingClientRect().top,n=o.current.getBoundingClientRect().top,r=o.current.getBoundingClientRect().bottom,c=l.current.getBoundingClientRect().top,a=l.current.getBoundingClientRect().bottom,s=_.current.getBoundingClientRect().top,d=_.current.getBoundingClientRect().bottom;t>=n&&t<r?i("one"):t>=c&&t<a?i("two"):t>=s&&t<d&&i("three")},children:[Object(j.jsxs)("div",{ref:o,className:"pt-10 ".concat(ee.a.burgerIngredients__ingredients),children:[Object(j.jsx)("h2",{className:"mb-6 text text_type_main-medium 1",children:"\u0411\u0443\u043b\u043a\u0438"}),Object(j.jsx)("ul",{className:"pl-2 ".concat(ee.a.burgerIngredients__items),children:s.filter((function(e){return"bun"===e.type})).map((function(e){return Object(j.jsx)(ce,{onClick:t,item:e,id:e._id},e._id)}))})]}),Object(j.jsxs)("div",{ref:l,className:"pt-10 ".concat(ee.a.burgerIngredients__ingredients),children:[Object(j.jsx)("h2",{className:"mb-6 text text_type_main-medium 2",children:"\u0421\u043e\u0443\u0441\u044b"}),Object(j.jsx)("ul",{className:"pl-2 ".concat(ee.a.burgerIngredients__items),children:s.filter((function(e){return"sauce"===e.type})).map((function(e){return Object(j.jsx)(ce,{onClick:t,item:e,id:e._id},e._id)}))})]}),Object(j.jsxs)("div",{ref:_,className:"pt-10 ".concat(ee.a.burgerIngredients__ingredients),children:[Object(j.jsx)("h2",{className:"mb-6 text text_type_main-medium 3",children:"\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u0438\u043d\u0433\u0440\u0438\u0434\u0438\u0435\u043d\u0442\u044b"}),Object(j.jsx)("ul",{className:"pl-2 ".concat(ee.a.burgerIngredients__items),children:s.filter((function(e){return"main"===e.type})).map((function(e){return Object(j.jsx)(ce,{onClick:t,item:e,id:e._id},e._id)}))})]})]})]})},ie=n(213),se=n(27),oe=n.n(se),le=n(110),_e=n.n(le),de="GET_ORDER_NUMBER_SUCCESS",ue="GET_ORDER_NUMBER_FAILED",me="GET_INGRIDIENTS_IDS",je="GET_INGRIDIENTS_CONSTRUCTOR",be="GET_BUN_CONSTRUCTOR",pe="GET_OTHER_INGRIDIENTS_CONSTRUCTOR",fe="DELETE_INGRIDIENT",xe="GET_TOTAL_PRICE",Oe="OPEN_ORDER_DATA",ge="CLOSE_ORDER_DATA",he="CONSTRUCTOR_INGREDIENTS_SORT",Ne="CLEAR_CONSTRUCTOR",ve="Bearer "+R("token"),ye=function(e){var t=e.deleteIngridient,n=e.item,c=e.id,a=e.index,i=h(),s=Object(r.useRef)(null),o=Object(ie.a)({accept:"sortIngridients-item",hover:function(e,t){var n;if(s.current){var r=e.index,c=a;if(r!==c){var o=null===(n=s.current)||void 0===n?void 0:n.getBoundingClientRect(),l=(o.bottom-o.top)/2,_=t.getClientOffset().y-o.top;r<c&&_<l||r>c&&_>l||(!function(e,t){i({type:he,dragIndex:e,hoverIndex:t}),i({type:je})}(r,c),e.index=c)}}}}),l=Object(p.a)(o,2)[1],_=Object(te.a)({type:"sortIngridients-item",item:function(){return{id:c,index:a}}});return(0,Object(p.a)(_,2)[1])(l(s)),Object(j.jsxs)("li",{ref:s,className:"".concat(_e.a.burgerConstructorIngridient),children:[Object(j.jsx)(m.DragIcon,{type:"primary"}),Object(j.jsx)(m.ConstructorElement,{handleClose:function(){t(n.secondId,n._id)},text:"".concat(n.name),price:n.price,thumbnail:"".concat(n.image)})]})},Ie=c.a.forwardRef((function(e,t){var n=e.onClick,c=g((function(e){return e.ingridients})).ingridients,a=g((function(e){return e.order})).constructorIngridients,i=g((function(e){return e.order})).totalPrice,s=g((function(e){return e.order})).modalOrderDetailsOpened,o=h(),l=a.find((function(e){return"bun"===e.type}));function _(e,t){o({type:fe,secondId:e,id:t})}var d=Object(ie.a)({accept:"ingredient",drop:function(e){var t,n=e.item;t=n._id,c.forEach((function(e){e._id===t&&("bun"===e.type?(o({type:be,bun:e}),o({type:je})):a[0]&&(o({type:pe,otherIngridient:Object(N.a)(Object(N.a)({},e),{},{secondId:Date.now().toString(36)+Math.random().toString(36).substr(2)})}),o({type:je})))}))}}),u=Object(p.a)(d,2)[1];return Object(r.useEffect)((function(){var e=0;a.map((function(t){return e+=t.price})),o({type:xe,totalPrice:e});var t=[];a.forEach((function(e,n){t[n]=e._id})),o({type:me,constructorIngridientId:t})}),[o,a]),Object(j.jsxs)("section",{className:"pt-25 ".concat(oe.a.burgerConstructor," "),children:[s?Object(j.jsx)("div",{className:"text text_type_main-large ".concat(oe.a.burgerConstructor__wrapperMessage," "),children:Object(j.jsx)("span",{className:"text text_type_main-large",children:"\u0412\u0430\u0448 \u0437\u0430\u043a\u0430\u0437 \u043f\u0440\u0438\u043d\u044f\u0442"})}):Object(j.jsxs)("div",{ref:u,className:"".concat(oe.a.burgerConstructor__wrapper," "),style:{display:"flex",flexDirection:"column",gap:"16px"},children:[l&&Object(j.jsx)("div",{className:"pl-8 pr-4 ".concat(oe.a.burgerConstructor__bunIngridient," "),children:Object(j.jsx)(m.ConstructorElement,{type:"top",isLocked:!0,text:"".concat(l.name," (\u0432\u0435\u0440\u0445)"),price:l.price,thumbnail:"".concat(l.image)},l.secondId)}),c&&Object(j.jsx)("ul",{className:"pr-2 ".concat(oe.a.burgerConstructor__mainIngridients," "),children:a.filter((function(e){return"main"===e.type||"sauce"===e.type})).map((function(e,t){return Object(j.jsx)(ye,{item:e,deleteIngridient:_,index:t,id:e._id},e.secondId)}))}),l&&Object(j.jsx)("div",{className:"pl-8 pr-4 ".concat(oe.a.burgerConstructor__bunIngridient," "),children:Object(j.jsx)(m.ConstructorElement,{type:"bottom",isLocked:!0,text:"".concat(l.name," (\u043d\u0438\u0437)"),price:l.price,thumbnail:"".concat(l.image)},l.secondId)})]}),Object(j.jsxs)("div",{className:"pr-4 mt-10 ".concat(oe.a.burgerConstructor__order),children:[i&&Object(j.jsx)("p",{className:"text text_type_digits-default ".concat(oe.a.burgerConstructor__count),children:i}),Object(j.jsx)("div",{className:"mr-10 ".concat(oe.a.burgerConstructor__icon),children:Object(j.jsx)(m.CurrencyIcon,{type:"primary"})}),Object(j.jsx)("div",{ref:t,children:Object(j.jsx)(m.Button,{onClick:n,type:"primary",size:"large",children:"\u041e\u0444\u043e\u0440\u043c\u0438\u0442\u044c \u0437\u0430\u043a\u0430\u0437"})})]})]})})),Ce=n(62),Te=n.n(Ce),ke=n(111),Ee=n.n(ke),Se=function(){return Object(j.jsx)("div",{className:Ee.a.modalOverlay})},De=document.getElementById("react-modals"),we=function(e){var t=e.onClose,n=e.children;if(!De)throw new Error("The element #portal wasn't found");return Object(r.useEffect)((function(){var e=function(e){"Escape"===e.key&&t()};return window.addEventListener("keydown",e),function(){return window.removeEventListener("keydown",e)}}),[t]),i.a.createPortal(Object(j.jsxs)("div",{className:Te.a.popup,onClick:function(){return t()},children:[Object(j.jsx)(Se,{}),Object(j.jsxs)("div",{className:Te.a.modal,onClick:function(e){e.stopPropagation()},children:[Object(j.jsx)("div",{className:Te.a.cross,onClick:function(){return t()},children:Object(j.jsx)(m.CloseIcon,{type:"primary"})}),n]})]}),De)},Re=n(50),Le=n.n(Re),Pe=function(){var e=g((function(e){return e.order})).orderNumber;return Object(j.jsxs)("div",{className:"pt-30 pb-30 ".concat(Le.a.orderDetails),children:[Object(j.jsx)("h2",{className:"text text_type_digits-large mb-8 ".concat(Le.a.title),children:e}),Object(j.jsx)("p",{className:"text text_type_main-medium mb-15 ".concat(Le.a.subtitle),children:"\u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440 \u0437\u0430\u043a\u0430\u0437\u0430"}),Object(j.jsx)("div",{className:"mb-15 ".concat(Le.a.icon),children:Object(j.jsx)(m.CheckMarkIcon,{type:"secondary"})}),Object(j.jsx)("p",{className:"text text_type_main-default mb-2",children:"\u0412\u0430\u0448 \u0437\u0430\u043a\u0430\u0437 \u043d\u0430\u0447\u0430\u043b\u0438 \u0433\u043e\u0442\u043e\u0432\u0438\u0442\u044c"}),Object(j.jsx)("p",{className:"text text_type_main-default text_color_inactive",children:"\u0414\u043e\u0436\u0434\u0438\u0442\u0435\u0441\u044c \u0433\u043e\u0442\u043e\u0432\u043d\u043e\u0441\u0442\u0438 \u043d\u0430 \u043e\u0440\u0431\u0438\u0442\u0430\u043b\u044c\u043d\u043e\u0439 \u0441\u0442\u0430\u043d\u0446\u0438\u0438"})]})},Be=n(211),Ae=n(115),Ue=function(){var e=g((function(e){return e.user})).user,t=g((function(e){return e.order})).orderNumber,n=Object(s.h)(),r=Object(s.g)(),a=g((function(e){return e.order})).constructorIngridientsId,i=h(),o=g((function(e){return e.order})).modalOrderDetailsOpened,l=g((function(e){return e.order})).constructorIngridients,_=c.a.useRef(null);return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)(Be.a,{backend:Ae.a,children:[Object(j.jsx)(ae,{onClick:function(e){i({type:C,indridientId:e.currentTarget.id})}}),Object(j.jsx)(Ie,{ref:_,onClick:function(t){if(t.preventDefault(),e){if(l.length){var c={ingredients:a};i({type:Oe}),i(function(e){return function(t){fetch("".concat(k,"/orders"),{method:"POST",headers:{"Content-Type":"application/json",authorization:ve||""},body:JSON.stringify(e)}).then(E).then((function(e){e&&e.success?t({type:de,orderNumber:e.order.number}):t({type:ue})})).catch((function(){t({type:ue})}))}}(c))}}else r.push("/login",{from:n})}})]}),o&&t&&Object(j.jsx)(we,{onClose:function(){i({type:ge}),i({type:Ne})},children:Object(j.jsx)(Pe,{})})]})},Ge=n(112),Me=n.n(Ge),ze=n(33),Fe=n.n(ze),We=function(){var e=g((function(e){return e.ingridients})).ingridients,t=Object(r.useState)(),n=Object(p.a)(t,2),c=n[0],a=n[1],i=Object(s.i)();return Object(r.useEffect)((function(){var t=e.find((function(e){return e._id===i.id}));a(t)}),[e,i.id]),Object(j.jsx)(j.Fragment,{children:c&&Object(j.jsxs)("div",{className:"pt-10 pb-15 ".concat(Fe.a.ingredientDetails),children:[Object(j.jsx)("h2",{className:"pl-10 text text_type_main-large ".concat(Fe.a.title),children:"\u0414\u0435\u0442\u0430\u043b\u0438 \u0438\u043d\u0433\u0440\u0435\u0434\u0438\u0435\u043d\u0442\u0430"}),Object(j.jsx)("img",{className:"mb-4",src:c.image_large,alt:c.name}),Object(j.jsx)("p",{className:"mb-8 text text_type_main-medium",children:c.name}),Object(j.jsxs)("ul",{className:"".concat(Fe.a.infoItems),children:[Object(j.jsxs)("li",{className:"mr-5 ".concat(Fe.a.infoItem),children:[Object(j.jsx)("span",{className:"text text_type_main-default text_color_inactive mb-2",children:"\u041a\u0430\u043b\u043e\u0440\u0438\u0438, \u043a\u043a\u0430\u043b"}),Object(j.jsx)("span",{className:"text text_type_digits-default text_color_inactive",children:c.calories})]}),Object(j.jsxs)("li",{className:"mr-5 ".concat(Fe.a.infoItem),children:[Object(j.jsx)("span",{className:"text text_type_main-default text_color_inactive mb-2",children:"\u0411\u0435\u043b\u043a\u0438, \u0433"}),Object(j.jsx)("span",{className:"text text_type_digits-default text_color_inactive",children:c.proteins})]}),Object(j.jsxs)("li",{className:"mr-5 ".concat(Fe.a.infoItem),children:[Object(j.jsx)("span",{className:"text text_type_main-default text_color_inactive mb-2",children:"\u0416\u0438\u0440\u044b, \u0433"}),Object(j.jsx)("span",{className:"text text_type_digits-default text_color_inactive",children:c.fat})]}),Object(j.jsxs)("li",{className:"".concat(Fe.a.infoItem),children:[Object(j.jsx)("span",{className:"text text_type_main-default text_color_inactive mb-2",children:"\u0423\u0433\u043b\u0435\u0432\u043e\u0434\u044b, \u0433"}),Object(j.jsx)("span",{className:"text text_type_digits-default text_color_inactive",children:c.carbohydrates})]})]})]})})},He=function(){return Object(j.jsx)("div",{className:"pt-20 ".concat(Me.a.ingredientDetailsPage),children:Object(j.jsx)(We,{})})},Je=n(12),qe=n.n(Je),Ve=n(16),Ke=n.n(Ve),Qe=n(34),Xe=n.n(Qe),Ze=function(e){var t=e.item,n=e.index,r=e.withNumber,c=e.mainCounter;return Object(j.jsx)(j.Fragment,{children:r&&0===n?Object(j.jsxs)("li",{className:"".concat(Xe.a.ingredient),children:[Object(j.jsx)("div",{className:"".concat(Xe.a.imgContainer),children:Object(j.jsx)("img",{className:"".concat(Xe.a.img),src:null===t||void 0===t?void 0:t.image,alt:null===t||void 0===t?void 0:t.name})}),Object(j.jsx)("span",{className:"text text_type_main-default ".concat(Xe.a.mainCounter),children:"+".concat(c)})]}):Object(j.jsx)("li",{className:"".concat(Xe.a.ingredient),children:Object(j.jsx)("div",{className:"".concat(Xe.a.imgContainer),children:Object(j.jsx)("img",{className:"".concat(Xe.a.img),src:null===t||void 0===t?void 0:t.image,alt:null===t||void 0===t?void 0:t.name})})})})},Ye=function(e){var t,n=new Date(e),r=new Date(e),c=(r.setHours(0,0,0,0)-(new Date).setHours(0,0,0,0))/864e5;t=c<-3?r.toLocaleDateString("ru-RU"):new Intl.RelativeTimeFormat("ru",{numeric:"auto"}).format(c,"day");var a="".concat(t,", ").concat(n.getHours()>=10?n.getHours():"0"+n.getHours(),":").concat(n.getMinutes()>=10?n.getMinutes():"0"+n.getMinutes()," i-GMT").concat(n.getTimezoneOffset()<=0?"+"+n.getTimezoneOffset()/-60:"-"+n.getTimezoneOffset()/-60);return a.charAt(0).toUpperCase()+a.slice(1)},$e=function(e){var t=e.order,n=e.userOrder,c=t._id,a=Object(s.h)(),i=g((function(e){return e.ingridients})).ingridients,o=Object(r.useState)(0),l=Object(p.a)(o,2),_=l[0],d=l[1],b=Object(r.useState)(),f=Object(p.a)(b,2),x=f[0],O=f[1],h=Object(r.useState)(0),N=Object(p.a)(h,2),v=N[0],y=N[1],I=Object(r.useState)([]),C=Object(p.a)(I,2),T=C[0],k=C[1],E=Object(r.useState)(""),S=Object(p.a)(E,2),D=S[0],w=S[1],R=Object(r.useState)(""),L=Object(p.a)(R,2),P=L[0],B=L[1];Object(r.useEffect)((function(){var e=[];t.ingredients.forEach((function(t,n){i&&(e[n]=i.find((function(e){return e._id===t})))}));var n="done"===t.status?"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d":"\u0413\u043e\u0442\u043e\u0432\u0438\u0442\u0441\u044f";B(n);var r=0;e.map((function(e){if(e)return r+=e.price})),d(r),e.reverse();var c=e;k(e);var a=e.length>=6?e.slice(0,6):c;O(a);var s=e.length-6;y(s),w(Ye(t.createdAt))}),[i,t.createdAt,t.ingredients,t.status]);var A="\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d"===P?Ke.a.statusDone:Ke.a.statusPedding,U=n?"mb-3":"mb-6";return Object(j.jsx)("li",{className:"p-6 ".concat(Ke.a.order),children:Object(j.jsxs)(u.b,{to:{pathname:"".concat(a.pathname,"/").concat(c),state:{background:a}},className:"".concat(Ke.a.order_link),children:[Object(j.jsxs)("div",{className:"mb-6 ".concat(Ke.a.order__meta),children:[Object(j.jsx)("span",{className:"text text_type_digits-default ".concat(Ke.a.order__number),children:"#".concat(t.number)}),Object(j.jsx)("span",{className:"text text_type_main-default text_color_inactive ".concat(Ke.a.order__date),children:D})]}),Object(j.jsx)("span",{className:"".concat(U," text text_type_main-medium ").concat(Ke.a.order__title),children:t.name}),n?Object(j.jsx)("span",{className:"mb-6 text text_type_main-default ".concat(A),children:P}):null,Object(j.jsxs)("div",{className:"".concat(Ke.a.order__info),children:[Object(j.jsx)("ul",{className:"".concat(Ke.a.order__ingredients),children:x&&x.map((function(e,t){return e&&T.length>=6?Object(j.jsx)(Ze,{item:e,index:t,withNumber:!0,mainCounter:v},t):Object(j.jsx)(Ze,{item:e,index:t,withNumber:!1,mainCounter:v},t)}))}),Object(j.jsxs)("div",{className:"".concat(Ke.a.order__cost),children:[Object(j.jsx)("span",{className:"text text_type_digits-default mr-2 ".concat(Ke.a.order__costNumber),children:_}),Object(j.jsx)("div",{className:"".concat(Ke.a.order__icon),children:Object(j.jsx)(m.CurrencyIcon,{type:"primary"})})]})]})]})})},et="WS_CONNECTION_START",tt="WS_CONNECTION_CLOSE",nt="WS_CONNECTION_SUCCESS",rt="WS_CONNECTION_ERROR",ct="WS_CONNECTION_CLOSED",at="WS_GET_ALL_ORDERS",it="WS_USER_CONNECTION_START",st="WS_USER_CONNECTION_SUCCESS",ot="WS_USER_CONNECTION_ERROR",lt="WS_USER_CONNECTION_CLOSED",_t="WS_GET_USER_ORDERS",dt=function(){var e=h();Object(r.useEffect)((function(){return e({type:et}),function(){e({type:tt})}}),[e]);var t=g((function(e){return e.ws})),n=t.orders,c=t.totalToday,a=t.total;return Object(j.jsxs)("div",{className:"ml-5 ".concat(qe.a.feed),children:[Object(j.jsx)("h1",{className:"mt-10 mb-5 text text_type_main-large",children:"\u041b\u0435\u043d\u0442\u0430 \u0437\u0430\u043a\u0430\u0437\u043e\u0432"}),Object(j.jsxs)("div",{className:"".concat(qe.a.feed__container),children:[Object(j.jsx)("ul",{className:"mr-15 ".concat(qe.a.feed__orders),children:n.map((function(e){return Object(j.jsx)($e,{order:e,userOrder:!1},e._id)}))}),Object(j.jsxs)("div",{className:"".concat(qe.a.feed__info),children:[Object(j.jsxs)("div",{className:"mb-15 ".concat(qe.a.feed__status),children:[Object(j.jsxs)("div",{className:"mr-9 ".concat(qe.a.feed__statusContainer),children:[Object(j.jsx)("span",{className:"text text_type_main-medium mb-6 ".concat(qe.a.feed__statusTitle),children:"\u0413\u043e\u0442\u043e\u0432\u044b:"}),Object(j.jsx)("ul",{className:"".concat(qe.a.feed__statusList),children:n.filter((function(e){return"done"===e.status})).slice(0,10).map((function(e){return Object(j.jsx)("li",{className:"text text_type_digits-default ".concat(qe.a.feed__statusItem," ").concat(qe.a.feed__statusItemDone),children:e.number},e._id)}))})]}),Object(j.jsxs)("div",{className:"".concat(qe.a.feed__statusContainer),children:[Object(j.jsx)("span",{className:"text text_type_main-medium mb-6 ".concat(qe.a.feed__statusTitle),children:"\u0412 \u0440\u0430\u0431\u043e\u0442\u0435:"}),Object(j.jsx)("ul",{className:"".concat(qe.a.feed__statusList),children:n.filter((function(e){return"pending"===e.status})).slice(0,10).map((function(e){return Object(j.jsx)("li",{className:"text text_type_digits-default ".concat(qe.a.feed__statusItem),children:e.number},e._id)}))})]})]}),Object(j.jsxs)("div",{className:"mb-15 ".concat(qe.a.feed__statistics),children:[Object(j.jsx)("span",{className:"text text_type_main-medium ".concat(qe.a.feed__statisticsTitle),children:"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e \u0437\u0430 \u0432\u0441\u0435 \u0432\u0440\u0435\u043c\u044f:"}),Object(j.jsx)("span",{className:"text text_type_digits-large ".concat(qe.a.feed__statisticsInfo),children:a})]}),Object(j.jsxs)("div",{className:"".concat(qe.a.feed__statistics),children:[Object(j.jsx)("span",{className:"text text_type_main-medium ".concat(qe.a.feed__statisticsTitle),children:"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e \u0437\u0430 \u0441\u0435\u0433\u043e\u0434\u043d\u044f:"}),Object(j.jsx)("span",{className:"text text_type_digits-large ".concat(qe.a.feed__statisticsInfo),children:c})]})]})]})]})},ut=n(51),mt=n.n(ut),jt=function(){var e=h();Object(r.useEffect)((function(){return e({type:it}),function(){e({type:tt})}}),[e]);var t=g((function(e){return e.ws})).orders;return Object(j.jsxs)("div",{className:"".concat(mt.a.container),children:[Object(j.jsxs)("div",{className:"mt-30 ".concat(mt.a.menuContainer),children:[Object(j.jsx)(Z,{}),Object(j.jsx)("span",{className:"text text_type_main-default text_color_inactive mt-20 pl-5 ".concat(mt.a.menuInfo),children:"\u0412 \u044d\u0442\u043e\u043c \u0440\u0430\u0437\u0434\u0435\u043b\u0435 \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0441\u0432\u043e\u044e \u0438\u0441\u0442\u043e\u0440\u0438\u044e \u0437\u0430\u043a\u0430\u0437\u043e\u0432"})]}),Object(j.jsx)("ul",{className:"mt-10 ".concat(mt.a.orders),children:t.map((function(e){return Object(j.jsx)($e,{order:e,userOrder:!0},e._id)}))})]})},bt=n(60),pt=["children"],ft=function(e){var t=e.children,n=Object(bt.a)(e,pt),r=g((function(e){return e.user})).user;return Object(j.jsx)(s.b,Object(N.a)(Object(N.a)({},n),{},{render:function(e){var n=e.location;return r?t:Object(j.jsx)(s.a,{to:{pathname:"/login",state:{from:n}}})}}))},xt=n(10),Ot=n.n(xt),gt=function(){var e=g((function(e){return e.ws})).orders,t=g((function(e){return e.ingridients})).ingridients,n=h(),c=Object(r.useState)(),a=Object(p.a)(c,2),i=a[0],o=a[1],l=Object(r.useState)(""),_=Object(p.a)(l,2),d=_[0],u=_[1],b=Object(r.useState)(""),f=Object(p.a)(b,2),x=f[0],O=f[1],N=Object(r.useState)(0),v=Object(p.a)(N,2),y=v[0],I=v[1],C=Object(r.useState)(),T=Object(p.a)(C,2),k=T[0],E=T[1],S=Object(r.useState)(),D=Object(p.a)(S,2),w=D[0],R=D[1],L=Object(s.i)(),P=Object(r.useCallback)((function(e){return e.reduce((function(e,t){return e[t]?e[t]++:e[t]=1,e}),{})}),[]);Object(r.useEffect)((function(){if(0===e.length)return console.log(e.length),n({type:et}),function(){n({type:tt})};var r=e.find((function(e){return e._id===L.id}));if(o(r),i){var c="done"===i.status?"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d":"\u0413\u043e\u0442\u043e\u0432\u0438\u0442\u0441\u044f";u(c),O(Ye(i.createdAt));var a=[];i.ingredients.forEach((function(e,n){t&&(a[n]=t.find((function(t){return t._id===e})))})),R(a);var s=0;a.map((function(e){if(e)return s+=e.price})),I(s),E(P(i.ingredients))}}),[i,e,L.id,d,t,P,n]);var B=null===w||void 0===w?void 0:w.filter((function(e,t,n){return n.indexOf(e)===t})),A="\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d"===d?Ot.a.statusDone:Ot.a.statusPedding;return Object(j.jsx)(j.Fragment,{children:i&&Object(j.jsxs)("div",{className:"p-10 ".concat(Ot.a.container),children:[Object(j.jsx)("span",{className:"mb-5 text text_type_digits-default ".concat(Ot.a.number),children:"#".concat(i.number)}),Object(j.jsx)("h3",{className:"mb-2 text text_type_main-medium ".concat(Ot.a.title),children:"".concat(i.name)}),Object(j.jsx)("span",{className:"mb-15 text text_type_main-default ".concat(A),children:d}),Object(j.jsx)("span",{className:"mb-6 text text_type_main-medium ".concat(Ot.a.subtitle),children:"\u0421\u043e\u0441\u0442\u0430\u0432:"}),Object(j.jsx)("ul",{className:"".concat(Ot.a.orders),children:B&&B.map((function(e,t){return e&&k&&Object(j.jsxs)("li",{className:"".concat(Ot.a.order),children:[Object(j.jsx)("div",{className:"".concat(Ot.a.imgContainer),children:Object(j.jsx)("img",{className:"".concat(Ot.a.img),src:"".concat(e.image),alt:"#"})}),Object(j.jsx)("span",{className:"mr-4 text text_type_main-default ".concat(Ot.a.ingredientName),children:e.name}),Object(j.jsxs)("div",{className:"".concat(Ot.a.priceWrapper),children:[Object(j.jsx)("span",{className:"mr-1 text text_type_digits-default ".concat(Ot.a.count),children:k[e._id]}),Object(j.jsx)("span",{className:"mr-1 text text_type_main-default ".concat(Ot.a.multiplier),children:"\u0445"}),Object(j.jsx)("span",{className:"mr-2 text text_type_digits-default ".concat(Ot.a.price),children:e.price}),Object(j.jsx)("div",{className:"mr-6 ".concat(Ot.a.icon),children:Object(j.jsx)(m.CurrencyIcon,{type:"primary"})})]})]},t)}))}),Object(j.jsxs)("div",{className:"".concat(Ot.a.footer),children:[Object(j.jsx)("span",{className:"text text_type_main-default text_color_inactive ".concat(Ot.a.date),children:x}),Object(j.jsxs)("div",{className:"".concat(Ot.a.total\u0421ost),children:[Object(j.jsx)("span",{className:"mr-2 text text_type_digits-default ".concat(Ot.a.sum),children:y}),Object(j.jsx)("div",{className:"".concat(Ot.a.icon),children:Object(j.jsx)(m.CurrencyIcon,{type:"primary"})})]})]})]})})},ht=n(113),Nt=n.n(ht),vt=function(){return Object(j.jsx)("div",{className:"pt-20 ".concat(Nt.a.container),children:Object(j.jsx)(gt,{})})},yt=function(){var e=Object(s.g)(),t=Object(s.h)(),n="PUSH"===e.action&&t.state&&t.state.background,c=h(),a=R("token"),i="Bearer "+R("token"),o=R("refreshToken");return Object(r.useEffect)((function(){c((function(e){fetch("".concat(k,"/ingredients")).then(E).then((function(t){t&&t.success?e({type:y,ingridients:t.data,ingridientsRequest:!1,ingridientsFailed:!1}):e({type:I,ingridientsFailed:!0,ingridientsRequest:!1})})).catch((function(t){console.log(t),e({type:I,ingridientsFailed:!0,ingridientsRequest:!1})}))})),a&&c(P(i,o))}),[c,a,i,o,e]),Object(j.jsxs)("div",{className:l.a.app,children:[Object(j.jsx)(b,{}),Object(j.jsxs)("div",{className:l.a.app__container,children:[Object(j.jsxs)(s.d,{location:n||t,children:[Object(j.jsx)(ft,{path:"/profile/order",exact:!0,children:Object(j.jsx)(jt,{})}),Object(j.jsx)(ft,{path:"/profile/order/:id",exact:!0,children:Object(j.jsx)(vt,{})}),Object(j.jsx)(ft,{path:"/profile",exact:!0,children:Object(j.jsx)(Y,{})}),Object(j.jsx)(s.b,{path:"/login",exact:!0,children:Object(j.jsx)(B,{})}),Object(j.jsx)(s.b,{path:"/register",exact:!0,children:Object(j.jsx)(M,{})}),Object(j.jsx)(s.b,{path:"/forgot-password",exact:!0,children:Object(j.jsx)(W,{})}),Object(j.jsx)(s.b,{path:"/reset-password",exact:!0,children:Object(j.jsx)(q,{})}),Object(j.jsx)(s.b,{path:"/ingredients/:id",exact:!0,children:Object(j.jsx)(He,{})}),Object(j.jsx)(s.b,{path:"/",exact:!0,children:Object(j.jsx)(Ue,{})}),Object(j.jsx)(s.b,{path:"/feed",exact:!0,children:Object(j.jsx)(dt,{})}),Object(j.jsx)(s.b,{path:"/feed/:id",exact:!0,children:Object(j.jsx)(vt,{})})]}),n&&Object(j.jsx)(s.b,{path:"/ingredients/:id",exact:!0,children:Object(j.jsx)(we,{onClose:function(){e.goBack()},children:Object(j.jsx)(We,{})})}),n&&Object(j.jsx)(s.b,{path:"/feed/:id",exact:!0,children:Object(j.jsx)(we,{onClose:function(){e.goBack()},children:Object(j.jsx)(gt,{})})}),n&&Object(j.jsx)(s.b,{path:"/profile/order/:id",exact:!0,children:Object(j.jsx)(we,{onClose:function(){e.goBack()},children:Object(j.jsx)(gt,{})})})]})]})},It=n(31),Ct=n(43),Tt={constructorIngridientsId:[],constructorIngridients:[],buns:[],otherIngridients:[],totalPrice:0,modalOrderDetailsOpened:!1,orderNumber:""},kt={ingridients:[],ingridientsRequest:!1,ingridientsFailed:!1,modalIngredientDetailsOpened:!1,indridientId:""},Et={user:null},St={wsConnected:!1,orders:[],total:0,totalToday:0},Dt=Object(It.b)({ingridients:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:kt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case v:return Object(N.a)(Object(N.a)({},e),{},{ingridientsRequest:!0,ingridientsFailed:!1});case y:return Object(N.a)(Object(N.a)({},e),{},{ingridients:t.ingridients,ingridientsRequest:!1,ingridientsFailed:!1});case I:return Object(N.a)(Object(N.a)({},e),{},{ingridientsFailed:!0,ingridientsRequest:!1});case C:return Object(N.a)(Object(N.a)({},e),{},{modalIngredientDetailsOpened:!0,indridientId:t.indridientId});case T:return Object(N.a)(Object(N.a)({},e),{},{modalIngredientDetailsOpened:!1,indridientId:""});default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Et,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case S:return Object(N.a)(Object(N.a)({},e),{},{user:{name:t.name,email:t.email}});case D:return Object(N.a)(Object(N.a)({},e),{},{user:t.user});default:return e}},order:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Tt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Oe:return Object(N.a)(Object(N.a)({},e),{},{modalOrderDetailsOpened:!0});case ge:return Object(N.a)(Object(N.a)({},e),{},{modalOrderDetailsOpened:!1});case xe:return Object(N.a)(Object(N.a)({},e),{},{totalPrice:t.totalPrice});case de:return Object(N.a)(Object(N.a)({},e),{},{orderNumber:t.orderNumber});case ue:return Object(N.a)({},e);case me:return Object(N.a)(Object(N.a)({},e),{},{constructorIngridientsId:t.constructorIngridientId});case je:return Object(N.a)(Object(N.a)({},e),{},{constructorIngridients:e.buns.concat(e.otherIngridients)});case be:return Object(N.a)(Object(N.a)({},e),{},{buns:[t.bun]});case he:var n=Object(Ct.a)(e.otherIngridients),r=n.splice(t.dragIndex,1);return n.splice.apply(n,[t.hoverIndex,0].concat(Object(Ct.a)(r))),Object(N.a)(Object(N.a)({},e),{},{otherIngridients:n});case pe:return Object(N.a)(Object(N.a)({},e),{},{otherIngridients:[].concat(Object(Ct.a)(e.otherIngridients),[t.otherIngridient])});case fe:return Object(N.a)(Object(N.a)({},e),{},{constructorIngridients:Object(Ct.a)(e.constructorIngridients).filter((function(e){return e.secondId!==t.secondId})),otherIngridients:Object(Ct.a)(e.otherIngridients).filter((function(e){return e.secondId!==t.secondId}))});case Ne:return Object(N.a)(Object(N.a)({},e),{},{constructorIngridients:[],buns:[],otherIngridients:[],orderNumber:""});default:return e}},ws:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:St,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case it:case et:case tt:return Object(N.a)({},e);case nt:case st:return Object(N.a)(Object(N.a)({},e),{},{wsConnected:!0});case rt:case ct:case ot:case lt:return Object(N.a)(Object(N.a)({},e),{},{wsConnected:!1});case at:case _t:return Object(N.a)(Object(N.a)({},e),{},{orders:t.payload.orders,total:t.payload.total,totalToday:t.payload.totalToday});default:return e}}}),wt=n(114),Rt=["success"],Lt=function(e,t,n){return function(r){var c=null;return function(a){return function(i){var s=r.dispatch,o=i.type,l=R("token"),_=t.wsInit,d=t.wsClose,u=t.onOpen,m=t.onClose,j=t.onError,b=t.onMessage;o===_&&(c=n?new WebSocket("".concat(e,"?token=").concat(l)):new WebSocket("".concat(e,"/all"))),c&&(c.onopen=function(e){console.log("success"),s({type:u,payload:e})},c.onerror=function(e){console.log("fail"),console.log(e),s({type:j,payload:e})},c.onmessage=function(e){console.log("message");var t=e.data,n=JSON.parse(t),r=(n.success,Object(bt.a)(n,Rt));s({type:b,payload:r})},c.onclose=function(e){console.log("close"),s({type:m,payload:e})}),d&&o===d&&c&&c.close(),a(i)}}}},Pt="wss://norma.nomoreparties.space/orders",Bt={wsInit:et,wsClose:tt,onOpen:nt,onClose:ct,onError:rt,onMessage:at},At={wsInit:it,wsClose:tt,onOpen:st,onClose:lt,onError:ot,onMessage:_t},Ut=("object"===typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:It.c)(Object(It.a)(wt.a,Lt(Pt,Bt,!1),Lt(Pt,At,!0))),Gt=Object(It.d)(Dt,Ut);i.a.render(Object(j.jsx)(c.a.StrictMode,{children:Object(j.jsx)(u.a,{children:Object(j.jsx)(O.a,{store:Gt,children:Object(j.jsx)(yt,{})})})}),document.getElementById("root"))},21:function(e,t,n){e.exports={header:"appHeader_header__2hIab",container:"appHeader_container__mny_C",navigation:"appHeader_navigation__AEaEY",navigationLink:"appHeader_navigationLink__2fKxn",profile:"appHeader_profile__3k27z appHeader_navigationLink__2fKxn",linkText:"appHeader_linkText__1RqhX",navigationLink__active:"appHeader_navigationLink__active__2LgeJ"}},24:function(e,t,n){e.exports={menu:"asideMenu_menu__eQb-V",menu__item:"asideMenu_menu__item__1m_uH",menu__link:"asideMenu_menu__link__2vjit",menu__linkActive:"asideMenu_menu__linkActive__BTz_z"}},25:function(e,t,n){e.exports={login:"login_login__3KfeJ",login__title:"login_login__title__lIbPe",login__form:"login_login__form__D4_er",login__input:"login_login__input__3Scd2",login__wrapper:"login_login__wrapper__3-L4n",login__link:"login_login__link__1R8xg"}},26:function(e,t,n){e.exports={profile:"profile_profile__24xU4",profile__form:"profile_profile__form__w8NVP",profile__input:"profile_profile__input__3LEfb",profile__wrapper:"profile_profile__wrapper__35vVE",profile__info:"profile_profile__info__32GLv",profile__infoItem:"profile_profile__infoItem__2hVTh",profile__formActions:"profile_profile__formActions__1CbA6",profile__formActionsActive:"profile_profile__formActionsActive__3c64Z"}},27:function(e,t,n){e.exports={burgerConstructor:"burgerConstructor_burgerConstructor__1a2oL",burgerConstructor__wrapper:"burgerConstructor_burgerConstructor__wrapper__32hFB",burgerConstructor__wrapperMessage:"burgerConstructor_burgerConstructor__wrapperMessage__37pbo",burgerConstructor__mainIngridients:"burgerConstructor_burgerConstructor__mainIngridients__19NhQ",burgerConstructor__order:"burgerConstructor_burgerConstructor__order__3yBn7",burgerConstructor__count:"burgerConstructor_burgerConstructor__count__2MYdR",burgerConstructor__icon:"burgerConstructor_burgerConstructor__icon__2ZLmi"}},29:function(e,t,n){e.exports={registration:"registration_registration__3GJ0g",registration__title:"registration_registration__title__3500I",registration__form:"registration_registration__form__2QK6Q",registration__input:"registration_registration__input__3fIli",registration__wrapper:"registration_registration__wrapper__1JE-N",registration__link:"registration_registration__link__3NZ3C"}},30:function(e,t,n){e.exports={burgerIngredients:"burgerIngredients_burgerIngredients__3dlPK",burgerIngredients__scrollWrapper:"burgerIngredients_burgerIngredients__scrollWrapper__zpIk-",burgerIngredients__items:"burgerIngredients_burgerIngredients__items__2yS2s"}},32:function(e,t,n){e.exports={reset:"reset_reset__2LZQl",reset__title:"reset_reset__title__35WR9",reset__form:"reset_reset__form__3F8CX",reset__input:"reset_reset__input__1ZQek",reset__wrapper:"reset_reset__wrapper__22Bqz",reset__link:"reset_reset__link__PKgE0"}},33:function(e,t,n){e.exports={ingredientDetails:"ingredientDetails_ingredientDetails__37kMa",title:"ingredientDetails_title__1BxPy",infoItems:"ingredientDetails_infoItems__MxCYh",infoItem:"ingredientDetails_infoItem__2ctOi"}},34:function(e,t,n){e.exports={ingredient:"orderIngredientIcon_ingredient__i6Bkr",imgContainer:"orderIngredientIcon_imgContainer__30RR6",img:"orderIngredientIcon_img__2TnYN",mainCounter:"orderIngredientIcon_mainCounter__8aOx3"}},38:function(e,t,n){e.exports={forgot:"forgot_forgot__1q8e6",forgot__title:"forgot_forgot__title__GLm_k",forgot__form:"forgot_forgot__form__1dFvq",forgot__input:"forgot_forgot__input__2yFTO",forgot__wrapper:"forgot_forgot__wrapper__27RRF",forgot__link:"forgot_forgot__link__3goQn"}},50:function(e,t,n){e.exports={orderDetails:"orderDetails_orderDetails__3TXSI",title:"orderDetails_title__2LP8y",icon:"orderDetails_icon__3RQ2W"}},51:function(e,t,n){e.exports={container:"userOrdersPage_container__1xZ6F",menuInfo:"userOrdersPage_menuInfo__2-mzR",orders:"userOrdersPage_orders__KQ2Kn"}},61:function(e,t,n){e.exports={burgerIngredient:"burgerIngredient_burgerIngredient__3wi7I",burgerIngredient__item:"burgerIngredient_burgerIngredient__item__E4hPh",burgerIngredient__price:"burgerIngredient_burgerIngredient__price__2rkU3"}},62:function(e,t,n){e.exports={popup:"modal_popup__lnicy",modal:"modal_modal__1DF1f",cross:"modal_cross__3JYgg"}},83:function(e,t,n){e.exports={app:"app_app__M9MMq",app__container:"app_app__container__3GNZq"}}},[[206,1,2]]]);
//# sourceMappingURL=main.a1f3664c.chunk.js.map